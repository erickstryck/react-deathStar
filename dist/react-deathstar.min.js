!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("react-deathstar",[],t):"object"==typeof exports?exports["react-deathstar"]=t():e["react-deathstar"]=t()}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=r(2),c=i(a),u=r(3),h=i(u),l="",f=function(){function e(t){s(this,e),this.createElement=t.createElement,this.storage={},this.setStore.bind(this),this.checkKey.bind(this),this.htmlDict=[],this.minify=h.default.minify,this.minf.bind(this),this.builder.bind(this),this.putStore.bind(this),this.getStore.bind(this),this.deleteStore.bind(this),this.keys.bind(this)}return o(e,[{key:"builder",value:function(e,t,r){return r&&0===r.length&&(r=null),t=t.children?Object.assign({},t,{children:null}):t,t=-1!==Object.keys(t).indexOf("key")?Object.assign({},t,{key:t.key}):Object.assign({},t,{key:this.getId()}),this.createElement(e,t,r)}},{key:"clearBus",value:function(){this.storage={}}},{key:"putStore",value:function(e,t,r){if(!r)return this.storage[e]=t,t;t.deathStartUpdater=function(){t.forceUpdate()};var i={};Object.keys(t).map(function(e){"function"==typeof t[e]&&(i[e]=t[e])}),i.state=t.state,this.storage[e]=i}},{key:"getStore",value:function(e){return this.storage[e]}},{key:"deleteStore",value:function(e){delete this.storage[e]}},{key:"keys",value:function(){return Object.keys(this.storage)}},{key:"destroy",value:function(e){var t=this;if(e instanceof Array){var r=this.keys();e.map(function(e){r.map(function(r){r.split("-")[0]===e&&t.deleteStore(e)},t)},this)}else{this.keys().map(function(r){r.split("-")[0]===e&&t.deleteStore(r)},this)}}},{key:"minf",value:function(e){var t=this;return this.minify&&e.match(/(-\w[a-zA-Z]+)/g)&&e.match(/(-\w[a-zA-Z]+)/g).map(function(r){-1===t.htmlDict.indexOf(r.substring(1,e.length))&&(e=e.replace(r.substring(1,e.length),"t"))}),e}},{key:"container",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.props;return-1!==Object.keys(e).indexOf("key")&&e.key&&!t&&(r=Object.assign({},r,{key:e.key})),-1!==Object.keys(e).indexOf("ref")&&e.ref&&(r=Object.assign({},r,{ref:e.ref})),this.builder(e.type,r||null,-1!==Object.keys(e.props).indexOf("children")?this.processChildren(e.props.children,t):[])}},{key:"processChildren",value:function(e,t){return e?e instanceof Array?e.length>0?e.map(function(e){if(e)return e.type?this.container(e,t):e},this):null:e.type?this.container(e,t):e:null}},{key:"processElement",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.setStore(t,e,r);return this.mapChildrens(i.props.children,t),this.manipulate(t)}},{key:"mapChildrens",value:function(e,t){e&&(e instanceof Array?e.map(function(e,r){e&&(++r,e.props&&this.mapChildrens(e.props.children,t+"-"+this.haveTypeName(e.type)+r),e.props&&this.putStore(t+"-"+this.haveTypeName(e.type)+r,e.key))},this):(e.props&&this.mapChildrens(e.props.children,t+"-"+this.haveTypeName(e.type)+"1"),e.props&&this.putStore(t+"-"+this.haveTypeName(e.type)+"1",e.key)))}},{key:"haveTypeName",value:function(e){return this.minify&&"string"==typeof e&&-1===this.htmlDict.indexOf(e)&&this.htmlDict.push(e),e.displayName?e.displayName:e.name?e.name:e}},{key:"getId",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"_"+e()+"_"+e()+"_"+e()+"_"+e()+e()+e()}},{key:"setStore",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.putStore(e,this.container(t,r))}},{key:"manipulate",value:function(e){return e=this.minf(e),this.checkKey(e)?new c.default(e):""}},{key:"manipulateCopy",value:function(e,t){return e=this.minf(e),this.manipulate(e).copy(t)}},{key:"getElement",value:function(e){if(e=this.minf(e),this.checkKey(e)){var t=this.getStore(e),r=t.props?t.key:t,i=e.split("-");if(this.checkKey(i[0])){var n=this.getStore(i[0]);return n.key===r?n:this.walkChildren(n.props.children,r)}}}},{key:"setProps",value:function(e,t){if(!(e||t instanceof Object))return void console.log("metodo: setProps - Você precisa especificar uma key em string e um props no formato objeto!");if(this.checkKey(e)){var r=this.getElement(e);-1!==Object.keys(t).indexOf("ref")&&(r=Object.assign({},r,{ref:t.ref}),delete t.ref),r=this.swapPropsAttr(r,t),this.updateAllReferences(r)}}},{key:"walkChildren",value:function(e,t){var r="";if(e)if(e instanceof Array){for(var i=0;i<e.length;i++)if(e[i]){if(e[i].key===t)return e[i];if(e[i].props&&(r=this.walkChildren(e[i].props.children,t)),r&&r.key===t)return r}}else{if(e.key===t)return e;if(e.props&&(r=this.walkChildren(e.props.children,t)),r&&r.key===t)return r}}},{key:"copy",value:function(e,t){return this.checkKey(e)?this.processElement(this.getElement(e),t,!0):""}},{key:"setAttribute",value:function(e,t){if(!e&&!t||!(t instanceof Object))return void console.log("metodo: setAttributes - Você precisa especificar uma key em string e um atributo no formato objeto!");if(this.checkKey(e))if(t.ref){var r=this.getElement(e),i=Object.assign({},r,t);this.updateAllReferences(i)}else if(this.checkProps(e)){var n=this.getElement(e),s=this.swapPropsAttr(n,t);this.updateAllReferences(s)}}},{key:"modifyAttribute",value:function(e,t){var r=this;Object.keys(t).map(function(i){r.processModify(e,i,t[i])},this)}},{key:"processModify",value:function(e,t,r){if(!e&&!t&&!r)return void console.log("metodo: modifyAttribute - Você precisa especificar a key, o nome do atributo e seu valor por parâmetro!");if(this.checkKey(e)&&this.checkProps(e)&&(this.checkAttribute(e,t)||"ref"===t)){var i=this.getElement(e);if("ref"===t){var n=Object.assign({},i,{ref:r});this.updateAllReferences(n)}else{var s={};s[t]=r;var o=this.swapPropsAttr(i,s);this.updateAllReferences(o)}}}},{key:"removeAttribute",value:function(e,t){var r=this;t instanceof Array?t.map(function(t){r.processRemove(e,t)},this):this.processRemove(e,t)}},{key:"processRemove",value:function(e,t){if(!e&&!t)return void console.log("metodo: removeAttribute - Você precisa especificar uma key em string e o nome do atributo a ser removido!");if(this.checkKey(e)&&this.checkProps(e)){var r=this.getElement(e);if("ref"===t){var i=Object.assign({},r,{ref:null});this.updateAllReferences(i)}if(this.checkAttribute(e,t)){var n=Object.keys(r.props);n.splice(n.indexOf(t),1);var s={};n.map(function(e){s[e]=r.props[e]});var o=Object.assign({},r,{props:s});this.updateAllReferences(o)}}}},{key:"setChildren",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e&&!t)return void console.log("metodo: setChildren - Você precisa especificar a key e um elemento a ser inserido!");if(this.checkKey(e)){var s=this.getElement(e);if(this.checkProps(e))if(s.props.children)if(t instanceof Array){var o=s.props.children;o instanceof Array||(o=new Array(o));var a={};if(r){var c,u;r--,i?(c=o).splice.apply(c,[r,0].concat(n(t))):(u=o).splice.apply(u,[r,1].concat(n(t))),a=this.swapPropsAttr(s,{children:o})}else a=this.swapPropsAttr(s,{children:o.concat(t)});this.updateAllReferences(a)}else{var h=s.props.children instanceof Array?s.props.children:new Array(s.props.children);r?(r--,i?h.splice(r,0,t):h[r]=t):h.push(t);var l=this.swapPropsAttr(s,{children:h});this.updateAllReferences(l)}else{var f=this.swapPropsAttr(s,{children:t});this.updateAllReferences(f)}}}},{key:"removeChildren",value:function(e,t){var r=this;t instanceof Array&&-1!==t?t.map(function(t){r.processRemoveChildren(e,t)},this):-1===t?this.processResetChildren(e):this.processRemoveChildren(e,t)}},{key:"processRemoveChildren",value:function(e,t){if(t--,!e&&t)return void console.log("metodo: removeChildren - Você precisa especificar a key onde será retirada a children e o índice que corresponde a children a ser removida!");if(this.checkKey(e)){var r=this.getElement(e);if(r.props.children instanceof Array){var i=r.props.children.filter(function(e,r){return t!==r}),n=this.swapPropsAttr(r,{children:i});this.updateAllReferences(n)}else{var s=this.swapPropsAttr(r,{children:null});this.updateAllReferences(s)}}else console.log("Chave não encontrada!")}},{key:"processResetChildren",value:function(e){if(!e)return void console.log("metodo: removeChildren - Você precisa especificar a key onde será retirada os childrens !");if(this.checkKey(e)){var t=this.getElement(e),r=this.swapPropsAttr(t,{children:null});this.updateAllReferences(r)}else console.log("Chave não encontrada!")}},{key:"updateAllReferences",value:function(e){this.keys().map(function(t){var r=this.getStore(t);if(r.props)if(r.key!==e.key){var i=this.checkChildrensInArray(e,r);this.putStore(t,this.processElement(this.swapPropsAttr(r,{children:i}),t).getElement())}else this.putStore(t,this.processElement(e,t).getElement())},this)}},{key:"checkChildrensInArray",value:function(e,t){if(t&&t.props){var r=t.props.children,i=[];if(r&&r instanceof Array)return r.map(function(t){var r=this.checkChildrensInArray(e,t);i=this.compareChildrens(e,t,i,r)},this),i;if(r&&r.props){var n=this.checkChildrensInArray(e,r);return i=this.compareChildrens(e,r,i,n)}return r}return t}},{key:"compareChildrens",value:function(e,t,r,i){return t&&t.key&&t.key===e.key?r.push(e):t&&t.props?r.push(this.swapPropsAttr(t,{children:i})):r.push(t),r}},{key:"swapPropsAttr",value:function(e,t){var r=Object.assign({},e.props,t);return Object.assign({},e,{props:r})}},{key:"checkKey",value:function(e){return-1!==this.keys().indexOf(e)}},{key:"checkProps",value:function(e){return!!this.checkKey(e)&&-1!==Object.keys(this.getElement(e)).indexOf("props")}},{key:"checkAttribute",value:function(e,t){return!!this.checkKey(e)&&(!!this.checkProps(e)&&-1!==Object.keys(this.getElement(e).props).indexOf(t))}}],[{key:"getInstance",value:function(t){return l||(l=new e(t))}}]),e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=n.default},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(t){i(this,e),this.instance=o.default.getInstance(),this.key=this.instance.minf(t)}return n(e,[{key:"getMyKey",value:function(){return this.key}},{key:"getElement",value:function(){return this.instance.getElement(this.key)}},{key:"copy",value:function(e){return this.instance.copy(this.key,e)}},{key:"setAttribute",value:function(e){return this.instance.setAttribute(this.key,e),this}},{key:"setProps",value:function(e){return this.instance.setProps(this.key,e),this}},{key:"modifyAttribute",value:function(e){return this.instance.modifyAttribute(this.key,e),this}},{key:"removeAttribute",value:function(e){return this.instance.removeAttribute(this.key,e),this}},{key:"setChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.instance.setChildren(this.key,e,t,r),this}},{key:"removeChildren",value:function(e){return this.instance.removeChildren(this.key,e),this}},{key:"checkAttribute",value:function(e){return this.instance.checkAttribute(this.key,e)}},{key:"manipulateCopy",value:function(e){return this.instance.manipulateCopy(this.key,e)}},{key:"manipulate",value:function(e){return this.key=this.instance.minf(e),this}},{key:"destroy",value:function(e){return this.instance.destroy(e),this}}]),e}();t.default=a},function(e,t,r){"use strict";var i={minify:!0};e.exports=i}])});