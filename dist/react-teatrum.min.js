!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define("react-teatrum",["react"],t):"object"==typeof exports?exports["react-teatrum"]=t(require("react")):e["react-teatrum"]=t(e.React)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=o.default},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Theatrum=t.Actor=t.Scene=t.Stage=t.Staff=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(2),p=function(e){return e&&e.__esModule?e:{default:e}}(c),l="";try{l=r(!function(){var e=new Error('Cannot find module "../../../death-star-minify.conf"');throw e.code="MODULE_NOT_FOUND",e}())}catch(e){console.error("You need to create a configuration file for the library, please read the documentation at https://github.com/erickstryck/react-deathStar/blob/master/README.md"),l={minify:!1}}l=l.minify;var u="",h=function(){function e(){a(this,e),this.storage={},this.htmlDict=[]}return i(e,null,[{key:"getInstance",value:function(){return u||(u=new e)}},{key:"clearStorage",value:function(){e.getInstance().storage={}}},{key:"setItemStorage",value:function(t,r){e.getInstance().storage[t]=r}},{key:"getHtmlDict",value:function(){return e.getInstance().htmlDict}},{key:"setHtmlDict",value:function(t){e.getInstance().htmlDict.push(t)}},{key:"putStore",value:function(t,r,n){if(n){r.update=function(){r.setState({theatrumUpdater:!!r.theatrumUpdater})};for(var o={},s=Object.keys(r),a=0;a<s.length;a++){var i=s[a];"function"==typeof r[i]&&(o[i]=r[i])}o.state=r.state,e.getInstance().storage[t]=o}else e.getInstance().storage[t]=r;return r}},{key:"getStore",value:function(t){var r="";try{r=e.getInstance().storage[t]}catch(e){console.error("The key '"+t+"' does not exist")}return r}},{key:"deleteStore",value:function(t){delete e.getInstance().storage[t]}},{key:"getKeys",value:function(){return Object.keys(e.getInstance().storage)}}]),e}(),f=function(e){return function(t){function r(t){a(this,r);var n=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return n.state={staff:b,key:e},n}return s(r,t),i(r,[{key:"render",value:function(){var e=b.getElement(this.state.key,!0);return e||(e=b.processElement(p.default.createElement("div",this.props),this.state.key,!1,this)),e}}]),r}(c.Component)},d=function(e){if(!e.name||!e.path)return console.error({error:"You need to enter the props 'name' and 'path' for the component."}),null;var t=new(f("stage_"+e.name))(e);return h.putStore("class_"+e.name,t),h.putStore("path_"+e.path,e.name),h.getStore("class_"+e.name)},g=function(e){return e.name&&e.init?(e.browser&&"/"!=window.location.pathname&&(e=b.swapPropsAttr({props:e},{init:window.location.pathname}).props),new(function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.getAllPaths=r.getAllPaths.bind(r),r.handleBrowserHistory=r.handleBrowserHistory.bind(r),r.push=r.push.bind(r),r.back=r.back.bind(r),r.reset=r.reset.bind(r),r.currentPath=r.currentPath.bind(r),r.injectOwner=r.injectOwner.bind(r),h.putStore("state_path_"+r.props.name,{push:r.push,back:r.back,forward:r.forward,reset:r.reset,currentPath:r.currentPath});var n=r.getAllPaths(r.props.children);return r.state={storage:h,currentClass:"",path:n,idx:[n.indexOf(r.props.init)]},r}return s(t,e),i(t,[{key:"getAllPaths",value:function(e){var t=[];if(e instanceof Array)for(var r=0;r<e.length;r++)e[r].props.path&&t.push(e[r].props.path);else e.props.path&&t.push(e.props.path);return t}},{key:"handleBrowserHistory",value:function(){if(this.props.browser){var e=JSON.parse(window.localStorage.getItem("theatrumPaths"));e&&(!e.history&&this.state.path.indexOf(window.location.pathname)>0?e.idx.slice(-1)[0]!=this.state.path.indexOf(window.location.pathname)&&e.idx.push(this.state.path.indexOf(window.location.pathname)):this.state.path.indexOf(window.location.pathname)<0&&e.idx.push(this.state.path.indexOf(this.props.redirect)),this.state.path=e.path,this.state.idx=e.idx,e.history=!1,window.localStorage.setItem("theatrumPaths",JSON.stringify(e)))}}},{key:"componentDidMount",value:function(){var e=h.getStore("class_"+h.getStore("path_"+this.state.path[this.state.idx.slice(-1)[0]]));if(this.props.browser&&!this.props.ignorePersistence){var t=window.localStorage.getItem("theatrumProps_"+this.state.path[this.state.idx.slice(-1)[0]]);t&&(e.props=Object.assign({},e.props,JSON.parse(t)),h.setItemStorage("class_"+h.getStore("path_"+this.state.path[this.state.idx.slice(-1)[0]]),e))}b.setContext("theatrum_"+this.props.name,this),this.setState({currentClass:e})}},{key:"push",value:function(e,t){var r=this.state.path.indexOf(e);this.state.idx.slice(-1)[0]!=r&&this.state.idx.push(r),r<0&&(r=this.state.path.indexOf(this.props.redirect)),e=this.state.path[r];var n=h.getStore("class_"+h.getStore("path_"+e));n.props=Object.assign({},n.props,t),h.setItemStorage("class_"+h.getStore("path_"+e),n),this.props.browser&&(window.history.replaceState("","",e),t&&window.localStorage.setItem("theatrumProps_"+e,JSON.stringify(t)),window.localStorage.setItem("theatrumPaths",JSON.stringify({idx:this.state.idx,path:this.state.path,history:!0}))),this.setState({currentClass:n})}},{key:"back",value:function(e){this.state.idx.pop();var t=this.state.idx.slice(-1)[0];if(t>=0){var r=h.getStore("class_"+h.getStore("path_"+this.state.path[t]));r.props=Object.assign({},r.props,e),h.setItemStorage("class_"+h.getStore("path_"+this.state.path[t]),r),this.props.browser&&(window.history.replaceState("","",this.state.path[t]),e&&window.localStorage.setItem("theatrumProps_"+this.state.path[t],JSON.stringify(e)),window.localStorage.setItem("theatrumPaths",JSON.stringify({idx:this.state.idx,path:this.state.path,history:!0}))),this.setState({currentClass:r})}}},{key:"reset",value:function(e){this.state.idx=[this.props.init];var t=this.state.idx.slice(-1)[0],r=h.getStore("class_"+h.getStore("path_"+this.state.path[t]));r.props=Object.assign({},r.props,e),h.setItemStorage("class_"+h.getStore("path_"+this.state.path[t]),r),this.props.browser&&(window.history.replaceState("","",this.state.path[t]),e&&window.localStorage.setItem("theatrumProps_"+this.state.path[t],JSON.stringify(e)),window.localStorage.setItem("theatrumPaths",JSON.stringify({idx:this.state.idx,path:this.state.path,history:!0}))),this.setState({currentClass:r})}},{key:"currentPath",value:function(){return this.state.path[this.state.idx.slice(-1)[0]]}},{key:"injectOwner",value:function(e){var t=e.children;if(t instanceof Array){for(var r=[],n=0;n<t.length;n++)r.push(b.swapPropsAttr(t[n],{owner:this.props.name}));t=r}else t=b.swapPropsAttr(t,{owner:this.props.name});return b.swapPropsAttr({props:e},{children:t}).props}},{key:"render",value:function(){return this.handleBrowserHistory(),this.state.currentClass?this.state.currentClass.update?this.state.currentClass.render():this.state.currentClass:this.injectOwner(this.props).children}}]),t}(c.Component))(e)):(console.error("You need to enter the props 'name' and 'init' for the component."),null)},m=function(e){return e.name?new(f("scene_"+e.name))(e):(console.error("You need to enter the props 'name' for the component."),null)},v=function(e){return e.name?new(f("actor_"+e.name))(e):(console.error("You need to enter the props 'name' for the component."),null)},b={builder:function(e,t,r){return r&&0===r.length&&(r=null),t=t.children?Object.assign({},t,{children:null}):t,t=Object.assign({},t,{key:this.getId()}),p.default.createElement(e||"div",t,r)},clearBus:function(){h.clearStorage()},injectReact:function(e){Store.getInstance(e)},setContext:function(e,t){h.putStore(e+"_context",t,!0)},getContext:function(e){return h.getStore(e+"_context")},putStore:function(e,t,r){return h.putStore(e,t,r)},getStore:function(e){return h.getStore(e)},deleteStore:function(e){h.deleteStore(e)},keys:function(){return h.getKeys()},destroy:function(e){var t=b.keys();if(e instanceof Array)for(var r=0;r<e.length;r++)for(y=0;y<t.length;y++){var n=e[r],o=t[y];o.split("-")[0]===n&&h.deleteStore(n)}else for(y=0;y<t.length;y++){var s=t[y];s.split("-")[0]===e&&h.deleteStore(s)}},minf:function(e){if(l){e.match(/(-\w[a-zA-Z]+)/g)&&e.match(/(-\w[a-zA-Z]+)/g).map(function(t){-1===h.getHtmlDict().indexOf(t.substring(1,e.length))&&(e=e.replace(t.substring(1,e.length),"t"))})}return e},container:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.props;return-1!==Object.keys(e).indexOf("key")&&e.key&&!t&&(r=Object.assign({},r,{key:e.key})),-1!==Object.keys(e).indexOf("ref")&&e.ref&&(r=Object.assign({},r,{ref:e.ref})),b.builder(e.type,r||null,-1!==Object.keys(e.props).indexOf("children")?b.processChildren(e.props.children,t):[])},processChildren:function(e,t){return e?e instanceof Array?e.length>0?e.map(function(e){if(e)return e.type?b.container(e,t):e}):null:e.type?b.container(e,t):e:null},processElement:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments[3],o=b.setStore(t,e,r);return b.mapChildrens(o.props.children,t),n&&b.setContext(t,n),e},propagateUpdates:function(e){b.getContext(e.split("-")[0]).update()},mapChildrens:function(e,t){if(e)if(e instanceof Array)for(var r=0;r<e.length;r++){var n=e[r];n&&(++r,n.props&&b.mapChildrens(n.props.children,t+"-"+b.haveTypeName(n.type)+r),n.props&&b.putStore(t+"-"+b.haveTypeName(n.type)+r,n.key))}else e.props&&b.mapChildrens(e.props.children,t+"-"+b.haveTypeName(e.type)+"1"),e.props&&b.putStore(t+"-"+b.haveTypeName(e.type)+"1",e.key)},haveTypeName:function(e){return l&&"string"==typeof e&&-1===h.getHtmlDict().indexOf(e)&&h.setHtmlDict(e),e.displayName?e.displayName:e.name?e.name:e},getId:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"_"+e()+"_"+e()+"_"+e()+"_"+e()+e()+e()},setStore:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b.putStore(e,b.container(t,r))},getElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=b.minf(e),b.checkKey(e,t)){var r=b.getStore(e),n=r.props?r.key:r,o=e.split("-");if(b.checkKey(o[0])){var s=b.getStore(o[0]);return s.key===n?s:b.walkChildren(s.props.children,n)}}},setProps:function(e,t){if(!(e||t instanceof Object))return void console.log("metodo: setProps - Você precisa especificar uma key em string e um props no formato objeto!");if(b.checkKey(e)){var r=b.getElement(e);-1!==Object.keys(t).indexOf("ref")&&(r=Object.assign({},r,{ref:t.ref}),delete t.ref),r=b.swapPropsAttr(r,t),b.updateAllReferences(r)}},walkChildren:function(e,t){var r="";if(e)if(e instanceof Array){for(var n=0;n<e.length;n++)if(e[n]){if(e[n].key===t)return e[n];if(e[n].props&&(r=b.walkChildren(e[n].props.children,t)),r&&r.key===t)return r}}else{if(e.key===t)return e;if(e.props&&(r=b.walkChildren(e.props.children,t)),r&&r.key===t)return r}},copy:function(e,t){return b.checkKey(e)&&b.processElement(b.getElement(e),t,!0),b.getElement(t)},setAttribute:function(e,t){if(!e&&!t||!(t instanceof Object))return void console.log("metodo: setAttributes - Você precisa especificar uma key em string e um atributo no formato objeto!");if(b.checkKey(e))if(t.ref){var r=b.getElement(e),n=Object.assign({},r,t);b.updateAllReferences(n)}else if(b.checkProps(e)){var o=b.getElement(e),s=b.swapPropsAttr(o,t);b.updateAllReferences(s)}},modifyAttribute:function(e,t){for(var r=Object.keys(t),n=0;n<r.length;n++){var o=r[n];b.processModify(e,o,t[o])}},processModify:function(e,t,r){if(!e&&!t&&!r)return void console.log("metodo: modifyAttribute - Você precisa especificar a key, o nome do atributo e seu valor por parâmetro!");if(b.checkKey(e)&&b.checkProps(e)&&(b.checkAttribute(e,t)||"ref"===t)){var n=b.getElement(e);if("ref"===t){var o=Object.assign({},n,{ref:r});b.updateAllReferences(o)}else{var s={};s[t]=r;var a=b.swapPropsAttr(n,s);b.updateAllReferences(a)}}},removeAttribute:function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++){var n=t[r];b.processRemove(e,n)}else b.processRemove(e,t)},processRemove:function(e,t){if(!e&&!t)return void console.log("metodo: removeAttribute - Você precisa especificar uma key em string e o nome do atributo a ser removido!");if(b.checkKey(e)&&b.checkProps(e)){var r=b.getElement(e);if("ref"===t){var n=Object.assign({},r,{ref:null});b.updateAllReferences(n)}if(b.checkAttribute(e,t)){var o=Object.keys(r.props);o.splice(o.indexOf(t),1);for(var s={},a=0;a<o.length;a++){var i=o[a];s[i]=r.props[i]}var c=Object.assign({},r,{props:s});b.updateAllReferences(c)}}},setChildren:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e&&!t)return void console.log("metodo: setChildren - Você precisa especificar a key e um elemento a ser inserido!");if(b.checkKey(e)){var s=b.getElement(e);if(b.checkProps(e))if(s.props.children){var a="";if(t instanceof Array){a=s.props.children,a instanceof Array||(a=new Array(a));var i={};if(r){var c,p;r--,o?(c=a).splice.apply(c,[r,0].concat(n(t))):(p=a).splice.apply(p,[r,1].concat(n(t))),i=b.swapPropsAttr(s,{children:a})}else i=b.swapPropsAttr(s,{children:a.concat(t)});b.updateAllReferences(i)}else{a=s.props.children instanceof Array?s.props.children:new Array(s.props.children),r?(r--,o?a.splice(r,0,t):a[r]=t):a.push(t);var l=b.swapPropsAttr(s,{children:a});b.updateAllReferences(l)}}else{var u=b.swapPropsAttr(s,{children:t});b.updateAllReferences(u)}}},removeChildren:function(e,t){if(t instanceof Array&&-1!==t)for(var r=0;r<t.length;r++){var n=t[r];b.processRemoveChildren(e,n)}else-1===t?b.processResetChildren(e):b.processRemoveChildren(e,t)},processRemoveChildren:function(e,t){if(t--,!e&&t)return void console.log("metodo: removeChildren - Você precisa especificar a key onde será retirada a children e o índice que corresponde a children a ser removida!");if(b.checkKey(e)){var r=b.getElement(e);if(r.props.children instanceof Array){var n=r.props.children.filter(function(e,r){return t!==r}),o=b.swapPropsAttr(r,{children:n});b.updateAllReferences(o)}else{var s=b.swapPropsAttr(r,{children:null});b.updateAllReferences(s)}}else console.log("Chave não encontrada!")},processResetChildren:function(e){if(!e)return void console.log("metodo: removeChildren - Você precisa especificar a key onde será retirada os childrens !");if(b.checkKey(e)){var t=b.getElement(e),r=b.swapPropsAttr(t,{children:null});b.updateAllReferences(r)}else console.log("Chave não encontrada!")},updateAllReferences:function(e){for(var t=b.keys(),r=0;r<t.length;r++){var n=t[r],o=b.getStore(n);o.props&&o.key==e.key&&b.processElement(e,n)}},swapPropsAttr:function(e,t){var r=Object.assign({},e.props,t);return Object.assign({},e,{props:r})},checkKey:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=-1!==b.keys().indexOf(e);return r||t||console.error('this key "'+e+'" was not found, see the available keys: '+b.keys()),r},checkProps:function(e){return!!b.checkKey(e)&&-1!==Object.keys(b.getElement(e)).indexOf("props")},checkAttribute:function(e,t){return!!b.checkKey(e)&&(!!b.checkProps(e)&&-1!==Object.keys(b.getElement(e).props).indexOf(t))}},k={getElement:function(e){return b.getElement(e)},copy:function(e,t){return e&&t?b.copy(e,t):void console.error("For cloning you must enter:an existing key and a new key")},keys:function(){return b.keys()},setAttribute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.setAttribute(e,t),r||b.propagateUpdates(e)},setProps:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.setProps(e,t),r||b.propagateUpdates(e)},modifyAttribute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.modifyAttribute(e,t),r||b.propagateUpdates(e)},removeAttribute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.removeAttribute(e,t),r||b.propagateUpdates(e)},setChildren:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];b.setChildren(e,t,r,n),o||b.propagateUpdates(e)},removeChildren:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.removeChildren(e,t),r||b.propagateUpdates(e)},checkAttribute:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b.checkAttribute(e,t)},stagePush:function(e,t,r){h.getStore("state_path_"+e).push(t,r)},stageBack:function(e,t){h.getStore("state_path_"+e).back(t)},stageForward:function(e,t){h.getStore("state_path_"+e).forward(t)},stageReset:function(e,t){h.getStore("state_path_"+e).reset(t)},destroy:function(e){b.destroy(e)}};t.Staff=k,t.Stage=d,t.Scene=m,t.Actor=v,t.Theatrum=g},function(t,r){t.exports=e}])});